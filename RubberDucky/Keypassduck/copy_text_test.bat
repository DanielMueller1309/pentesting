@ECHO ON

REM Aufgabe:
REM Kopiere alle Dateien aus Quelle nach Ziel
REM und benenne sie dabei fortlaufend numerisch um
REM und behalte den Dateityp bei

REM Lokale Parameter
SET Q=c:\
echo Q gesetzt
SET Ziel=%TMP%\passwords\listen
echo Ziel gesetzt
REM Startwert für die Nummer
SET Zahl=1000
echo Zahl gesetzt
SET Pfade=%Ziel%\pfade_text.md
echo Pfad gesetzt
SET Log=%Ziel%\copy_text.log
echo Log gesetzt
SET t=.txt
echo t gesetzt
REM Wir müssen erst die "Delayed Expansion" einschalten
SETLOCAL ENABLEDELAYEDEXPANSION
echo enable gemacht
mkdir %Ziel%
echo zielordner listen erstellt
copy NUL %Pfade% > NUL
echo pfade erstellt
copy NUL %Log% > NUL
echo Log erstellt
FOR /F  %%e IN ('dir /S/B %Q%*%t%') DO (
	echo begin der for
	echo %e%
	ECHO Alt: %%e >> %Log%
	SET /A Zahl+=1
	echo zahl gesetzt
	ECHO "[!Zahl!.%t% %%z](!Zahl!%t%)" >> %Pfade%
	ECHO Neu: %Ziel%\!Zahl!%t% >> %Log% & ECHO. >> %Log%
	echo vor kopieren
	echo wert von z %z%
	COPY %%e %Ziel%\!Zahl!%t% > NUL
	)