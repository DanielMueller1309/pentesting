@ECHO OFF

REM Aufgabe:
REM Kopiere alle Dateien aus Quelle nach Ziel
REM und benenne sie dabei fortlaufend numerisch um
REM und behalte den Dateityp bei

REM Lokale Parameter
SET Q=C:\
SET Ziel=%TMP%\passwords
REM Startwert für die Nummer
SET Zahl=1000
SET Pfade=%Ziel%\pfade.md
SET Log=%Ziel%\copy.log
SET t=.kdbx
REM Wir müssen erst die "Delayed Expansion" einschalten 
SETLOCAL ENABLEDELAYEDEXPANSION
copy NUL %Pfade% > NUL
copy NUL %Log% > NUL
FOR /F  %%e IN ('dir /S/B %Q%*%t%') DO (
	ECHO Alt: %%e >> %Log%
	SET /A Zahl+=1
	ECHO "[!Zahl!.%t% %%e](!Zahl!%t%)" >> %Pfade%
	ECHO Neu: %Ziel%\!Zahl!%t% >> %Log% & ECHO. >> %Log%
	COPY %%e %Ziel%\!Zahl!%t% > NUL
	)